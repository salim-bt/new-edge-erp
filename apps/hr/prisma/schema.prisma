generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Department {
  id          String  @id @default(uuid())
  name        String
  description String?
  HOD         HOD[]
  Staff       Staff[]
}

model Designation {
  id          String  @id @default(uuid())
  name        String
  description String?
  Staff       Staff[]
}

model HOD {
  id           String      @id @default(uuid())
  staffId      String?
  departmentId String?
  joining_date DateTime    @default(now())
  Department   Department? @relation(fields: [departmentId], references: [id])
  Staff        Staff?      @relation(fields: [staffId], references: [id])
}

model Leave {
  id           String      @id @default(uuid())
  from   DateTime
  to     DateTime
  reason String
  leaveTypeId  String
  staffId      String
  status       LeaveStatus @default(PENDING)
  LeaveType    LeaveType?  @relation(fields: [leaveTypeId], references: [id])
  Staff        Staff?      @relation(fields: [staffId], references: [id])
}

model LeaveBalance {
  id               String  @id @default(uuid())
  leaveTypeId      String?
  leaveBalance     Int
  status    LeaveBalanceStatus @default(ONGOING)
  staffId          String?
  Staff            Staff?  @relation(fields: [staffId], references: [id])
  LeaveType        LeaveType? @relation(fields: [leaveTypeId], references: [id])
}

enum LeaveBalanceStatus{
  ONGOING
  EXPIRED
}

model LeaveType {
  id           String  @id @default(uuid())
  name         String  @unique
  description  String?
  allowed      Int
  Leave        Leave[]
  LeaveBalance LeaveBalance[]
}

model Staff {
  id            String         @id @default(uuid())
  first_name    String
  last_name     String
  middle_name   String?
  gender        Gender         @default(MALE)
  email         String         @unique
  password      String
  phone_number  String         @unique
  joining_date  DateTime       @default(now())
  cid           String         @unique
  dob           DateTime
  address       String
  departmentId  String?
  designationId String?
  HOD           HOD[]
  Leave         Leave[]
  LeaveBalance  LeaveBalance[]
  Department    Department?    @relation(fields: [departmentId], references: [id])
  Designation   Designation?   @relation(fields: [designationId], references: [id])
}

enum Gender {
  MALE
  FEMALE
}

enum LeaveStatus {
  PENDING
  APPROVED
  REJECTED
}
